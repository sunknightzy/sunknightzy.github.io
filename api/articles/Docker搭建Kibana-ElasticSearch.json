{"title":"Docker搭建Kibana+ElasticSearch","uid":"61eea4bbe78b91308bbd442a5070c4bd","slug":"Docker搭建Kibana-ElasticSearch","date":"2018-04-04T05:19:11.000Z","updated":"2019-05-04T03:19:46.000Z","comments":true,"path":"api/articles/Docker搭建Kibana-ElasticSearch.json","keywords":null,"cover":"https://raw.githubusercontent.com/sunknightzy/picsee/main/Picsee/abnerworks.Typora/maxresdefault-ok9xVF.jpeg","content":"<h2 id=\"创建宿主机目录\"><a href=\"#创建宿主机目录\" class=\"headerlink\" title=\"创建宿主机目录\"></a>创建宿主机目录</h2><div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki material-theme\" style=\"background-color: #263238\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">mkdir</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">-p</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">/Users/oak/docker/elasticsearch/config</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">/Users/oak/docker/elasticsearch/data</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">/Users/oak/docker/elasticsearch/log</span></span></code></pre></div><h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><p>修改 elasticsearch.yml 配置文件允许外部访问 (默认配置就行)</p>\n<div class=\"language-yaml\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">yaml</span><pre class=\"shiki material-theme\" style=\"background-color: #263238\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #F07178\">network.host</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">0.0.0.0</span></span></code></pre></div><h2 id=\"启动ElasticSearch\"><a href=\"#启动ElasticSearch\" class=\"headerlink\" title=\"启动ElasticSearch\"></a>启动ElasticSearch</h2><div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki material-theme\" style=\"background-color: #263238\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">docker</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">run</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">--name</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">elasticsearch</span><span style=\"color: #EEFFFF\"> \\</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">-p </span><span style=\"color: #F78C6C\">9200</span><span style=\"color: #C3E88D\">:9200</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">-p</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">9300</span><span style=\"color: #C3E88D\">:9300</span><span style=\"color: #EEFFFF\"> \\</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">-e </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">discovery.type=single-node</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #EEFFFF\"> \\</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">-e </span><span style=\"color: #C3E88D\">ES_JAVA_OPTS=</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">-Xms512m -Xmx512m</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #EEFFFF\"> \\</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">-v </span><span style=\"color: #C3E88D\">/Users/oak/docker/elasticsearch/conf/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml</span><span style=\"color: #EEFFFF\"> \\</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">-v </span><span style=\"color: #C3E88D\">/Users/oak/docker/elasticsearch/data:/usr/share/elasticsearch/data</span><span style=\"color: #EEFFFF\"> \\</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">-d </span><span style=\"color: #C3E88D\">elasticsearch:6.7.1</span></span></code></pre></div><h2 id=\"启动Kibana\"><a href=\"#启动Kibana\" class=\"headerlink\" title=\"启动Kibana\"></a>启动Kibana</h2><div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki material-theme\" style=\"background-color: #263238\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">docker</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">run</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">--name</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">kibana</span><span style=\"color: #EEFFFF\"> \\</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">--link </span><span style=\"color: #C3E88D\">elasticsearch</span><span style=\"color: #EEFFFF\"> \\</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">-e </span><span style=\"color: #C3E88D\">ELASTICSEARCH_URL=http://elasticsearch:9200</span><span style=\"color: #EEFFFF\"> \\</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">-p </span><span style=\"color: #F78C6C\">5601</span><span style=\"color: #C3E88D\">:5601</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">-d</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">kibana:6.7.1</span></span></code></pre></div><h2 id=\"Elasticsearch-配置文件详解\"><a href=\"#Elasticsearch-配置文件详解\" class=\"headerlink\" title=\"Elasticsearch 配置文件详解\"></a>Elasticsearch 配置文件详解</h2><details class=\"custom-details\">\n<summary>展开配置文件 elasticsearch.yaml</summary>\n<p><div class=\"language-yaml\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">yaml</span><pre class=\"shiki material-theme\" style=\"background-color: #263238\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 所有的配置都可以使用环境变量，如： cluster.name: $&#123;CLUSTER_NAME&#125; 表示环境变量中有一个CLUSTER_NAME变量</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 下面列举一下elasticsearch的可配置项：</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 1. 集群名称，默认为elasticsearch：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">cluster.name</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">elasticsearch</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 2. 节点名称，es启动时会自动创建节点名称，但你也可进行配置：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">node.name</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">Franz Kafka</span><span style=\"color: #89DDFF\">&quot;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 3. 是否作为主节点，每个节点都可以被配置成为主节点，默认值为true：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">node.master</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #FF9CAC\">true</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 4. 是否存储数据，即存储索引片段，默认值为true：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">node.data</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #FF9CAC\">true</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># master和data同时配置会产生一些奇异的效果：</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 1) 当master为false，而data为true时，会对该节点产生严重负荷；</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 2) 当master为true，而data为false时，该节点作为一个协调者；</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 3) 当master为false，data也为false时，该节点就变成了一个负载均衡器。</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 你可以通过连接http://localhost:9200/_cluster/health或者http://localhost:9200/_cluster/nodes，或者使用插件http://github.com/lukas-vlcek/bigdesk或http://mobz.github.com/elasticsearch-head来查看集群状态</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 5. 每个节点都可以定义一些与之关联的通用属性，用于后期集群进行分片时的过滤：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">node.rack</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">rack314</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 6. 默认情况下，多个节点可以在同一个安装路径启动，如果你想让你的es只启动一个节点，可以进行如下设置：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">node.max_local_storage_nodes</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 7. 设置一个索引的分片数量，默认值为5：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">index.number_of_shards</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">5</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 8. 设置一个索引副本的数量，默认值为1：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">index.number_of_replicas</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">1</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 当你想要禁用分布式时，你可以进行如下设置：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">index.number_of_shards</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">1</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">index.number_of_replicas</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">0</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 这两个属性的设置直接影响集群中索引和搜索操作的执行。假设你有足够的机器来持有分片和副本，那么可以按如下规则设置这两个值：</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 1) 拥有更多的分片可以提升索引执行能力，并允许通过机器分发一个大型的索引；</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 2) 拥有更多的副本能够提升搜索执行能力以及集群能力。</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 对于一个索引来说，number_of_shards只能设置一次，而number_of_replicas可以使用索引更新设置API在任何时候被增加或者减少。</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># ElasticSearch关注负载均衡、迁移、从节点聚合结果等等。可以尝试多种设计来完成这些功能。</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 可以连接http://localhost:9200/A/_status来检测索引的状态。</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 9. 配置文件所在的位置，即elasticsearch.yml和logging.yml所在的位置：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">path.conf</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">/path/to/conf</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 10. 分配给当前节点的索引数据所在的位置：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">path.data</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">/path/to/data</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 可以选择的包含一个以上的位置，使得数据在文件级别跨越位置，这样在创建时就有更多的自由路径，如：</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># path.data: /path/to/data1,/path/to/data2</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 11. 临时文件位置：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">path.work</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">/path/to/work</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 12. 日志文件所在位置：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">path.logs</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">/path/to/logs</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 13. 插件安装位置：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">path.plugins</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">/path/to/plugins</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 14. 插件托管位置，若列表中的某一个插件未安装，则节点无法启动：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">plugin.mandatory</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">mapper-attachments,lang-groovy</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 15. JVM开始交换时，ElasticSearch表现并不好：你需要保障JVM不进行交换，</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\">#     可以将bootstrap.mlockall设置为true禁止交换：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">bootstrap.mlockall</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #FF9CAC\">true</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 请确保ES_MIN_MEM和ES_MAX_MEM的值是一样的，并且能够为ElasticSearch分配足够的内存，也为系统操作保留足够的内存。</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 16. 默认情况下，ElasticSearch使用0.0.0.0地址，并为http传输开启9200-9300端口，为节点到节点的通信开启9300-9400端口，也可以自行设置IP地址：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">network.bind_host</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">192.168.0.1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 17. publish_host设置其他节点连接此节点的地址，如果不设置的话，则自动获取，publish_host的地址必须为真实地址：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">network.publish_host</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">192.168.0.1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 18. bind_host和publish_host可以一起设置：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">network.host</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">192.168.0.1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 19. 可以定制该节点与其他节点交互的端口：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">transport.tcp.port</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">9300</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 20. 节点间交互时，可以设置是否压缩</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">transport.tcp.compress</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #FF9CAC\">true</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 21. 可以为Http传输监听定制端口：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">http.port</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">9200</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 22. 设置内容的最大长度：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">http.max_content_length</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">100mb</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 23. 禁止HTTP</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">http.enabled</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #FF9CAC\">false</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 24. 网关允许在所有集群重启后持有集群状态，集群状态的变更都会被保存下来，当第一次启用集群时，可以从网关中读取到状态，默认网关类型（也是推荐的）是local：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">gateway.type</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">local</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 25. 允许在N个节点启动后恢复过程：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">gateway.recover_after_nodes</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 26. 设置初始化恢复过程的超时时间：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">gateway.recover_after_time</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">5m</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 27. 设置该集群中可存在的节点上限：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">gateway.expected_nodes</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">2</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 28. 设置一个节点的并发数量，有两种情况，一种是在初始恢复过程中：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">cluster.routing.allocation.node_initial_primaries_recoveries</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">4</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 另一种是在添加、删除节点及调整时：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">cluster.routing.allocation.node_concurrent_recoveries</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">2</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 29. 设置恢复时的吞吐量，默认情况下是无限的：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">indices.recovery.max_size_per_sec</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 30. 设置从对等节点恢复片段时打开的流的数量上限：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">indices.recovery.concurrent_streams</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">5</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 31. 设置一个集群中主节点的数量，当多于三个节点时，该值可在2-4之间：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">discovery.zen.minimum_master_nodes</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 32. 设置ping其他节点时的超时时间，网络比较慢时可将该值设大：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">discovery.zen.ping.timeout</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C3E88D\">3s</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># http://elasticsearch.org/guide/reference/modules/discovery/zen.html上有更多关于discovery的设置。</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 33. 禁止当前节点发现多个集群节点，默认值为true：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">discovery.zen.ping.multicast.enabled</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #FF9CAC\">false</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 34. 设置新节点被启动时能够发现的主节点列表（主要用于不同网段机器连接）：</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">discovery.zen.ping.unicast.hosts</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">[</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">host1</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">host2:port</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">host3[portX-portY]</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># 35.设置是否可以通过正则或者_all删除或者关闭索引</span></span>\n<span class=\"line\"><span style=\"color: #546E7A; font-style: italic\"># action.destructive_requires_name 默认false 允许 可设置true不允许 </span></span></code></pre></div></p>\n</details>\n","feature":true,"text":"💡 全文聚焦 Docker 环境下 Kibana + ElasticSearch 单机部署，包含目录结构、配置模板和容器启动命令","permalink":"/post/Docker搭建Kibana-ElasticSearch","photos":[],"count_time":{"symbolsCount":"4.4k","symbolsTime":"4 mins."},"categories":[{"name":"Docker","slug":"Docker","count":6,"path":"api/categories/Docker.json"},{"name":"ElasticSearch","slug":"Docker/ElasticSearch","count":1,"path":"api/categories/Docker/ElasticSearch.json"}],"tags":[{"name":"Docker","slug":"Docker","count":6,"path":"api/tags/Docker.json"},{"name":"ElasticSearch","slug":"ElasticSearch","count":1,"path":"api/tags/ElasticSearch.json"},{"name":"Kibana","slug":"Kibana","count":1,"path":"api/tags/Kibana.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%88%9B%E5%BB%BA%E5%AE%BF%E4%B8%BB%E6%9C%BA%E7%9B%AE%E5%BD%95\"><span class=\"toc-text\">创建宿主机目录</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE\"><span class=\"toc-text\">配置</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%90%AF%E5%8A%A8ElasticSearch\"><span class=\"toc-text\">启动ElasticSearch</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%90%AF%E5%8A%A8Kibana\"><span class=\"toc-text\">启动Kibana</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Elasticsearch-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3\"><span class=\"toc-text\">Elasticsearch 配置文件详解</span></a></li></ol>","author":{"name":"GlassCat","slug":"blog-author","avatar":"/img/avatar.png","link":"/","description":"《论语·为政》<br/>吾尝终日不食，终夜不寝，以思无益，不如学也<br/>--孔子--","socials":{"github":"https://github.com/sunknightzy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/someaware","csdn":"","juejin":"","customs":{"mail":{"icon":"/svg/mail.svg","link":"mailto:593739859@qq.com"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"Docker搭建Nacos","uid":"b80b88ff323cbedbe9f9c88d7ffb2f8f","slug":"Docker搭建Nacos","date":"2018-04-04T06:31:11.000Z","updated":"2025-05-05T13:49:36.000Z","comments":true,"path":"api/articles/Docker搭建Nacos.json","keywords":null,"cover":"https://raw.githubusercontent.com/sunknightzy/picsee/main/Picsee/abnerworks.Typora/coverw5P6d6-KtzFAP.png","text":"💡 全文聚焦 Docker 环境下基于 MySQL 模式的 Nacos 单机部署，包含目录结构、配置模板和容器启动命令以及解决 Dubbo 连接失败的问题","permalink":"/post/Docker搭建Nacos","photos":[],"count_time":{"symbolsCount":"2.1k","symbolsTime":"2 mins."},"categories":[{"name":"Docker","slug":"Docker","count":6,"path":"api/categories/Docker.json"},{"name":"Nacos","slug":"Docker/Nacos","count":1,"path":"api/categories/Docker/Nacos.json"}],"tags":[{"name":"Docker","slug":"Docker","count":6,"path":"api/tags/Docker.json"},{"name":"Nacos","slug":"Nacos","count":1,"path":"api/tags/Nacos.json"}],"author":{"name":"GlassCat","slug":"blog-author","avatar":"/img/avatar.png","link":"/","description":"《论语·为政》<br/>吾尝终日不食，终夜不寝，以思无益，不如学也<br/>--孔子--","socials":{"github":"https://github.com/sunknightzy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/someaware","csdn":"","juejin":"","customs":{"mail":{"icon":"/svg/mail.svg","link":"mailto:593739859@qq.com"}}}},"feature":true},"next_post":{"title":"Docker 搭建 zookeeper 单机","uid":"a66406382ee33156e956b3755bbd8fe4","slug":"Docker-搭建-zookeeper-单机","date":"2018-04-04T04:39:16.000Z","updated":"2021-05-25T05:01:30.000Z","comments":true,"path":"api/articles/Docker-搭建-zookeeper-单机.json","keywords":null,"cover":"https://raw.githubusercontent.com/sunknightzy/picsee/main/Picsee/abnerworks.Typora/1*M6q8tmdf3a51UdxY5izllgEZwO6c-LVZygL.png","text":"💡 全文聚焦 Docker 环境下的 Zookeeper 单机部署，包含目录结构、配置模板和容器启动命令","permalink":"/post/Docker-搭建-zookeeper-单机","photos":[],"count_time":{"symbolsCount":566,"symbolsTime":"1 mins."},"categories":[{"name":"Docker","slug":"Docker","count":6,"path":"api/categories/Docker.json"},{"name":"Zookeeper","slug":"Docker/Zookeeper","count":1,"path":"api/categories/Docker/Zookeeper.json"}],"tags":[{"name":"Docker","slug":"Docker","count":6,"path":"api/tags/Docker.json"},{"name":"Zookeeper","slug":"Zookeeper","count":2,"path":"api/tags/Zookeeper.json"}],"author":{"name":"GlassCat","slug":"blog-author","avatar":"/img/avatar.png","link":"/","description":"《论语·为政》<br/>吾尝终日不食，终夜不寝，以思无益，不如学也<br/>--孔子--","socials":{"github":"https://github.com/sunknightzy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/someaware","csdn":"","juejin":"","customs":{"mail":{"icon":"/svg/mail.svg","link":"mailto:593739859@qq.com"}}}},"feature":true}}