{"title":"åˆ†å¸ƒå¼IDè®¾è®¡æ–¹æ¡ˆ","uid":"78eda1e73784e2bed9dff22f7b33de09","slug":"åˆ†å¸ƒå¼IDè®¾è®¡æ–¹æ¡ˆ","date":"2017-08-25T05:04:29.000Z","updated":"2019-05-03T08:24:49.000Z","comments":true,"path":"api/articles/åˆ†å¸ƒå¼IDè®¾è®¡æ–¹æ¡ˆ.json","keywords":null,"cover":"https://raw.githubusercontent.com/sunknightzy/picsee/main/Picsee/abnerworks.Typora/image-1721273128294-XKUAxI.png","content":"<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>æ˜¯çš„ï¼Œä¹‹å‰éƒ¨é—¨å¸ƒç½®çš„ä»»åŠ¡å®Œæˆçš„ä¸é”™ï¼Œè€å¤§ç»§ç»­ç»™æˆ‘åˆ†é…äº†ä¸€ä¸ªè®¾è®¡åˆ†å¸ƒå¼IDæ–¹æ¡ˆçš„ä»»åŠ¡ï¼Œä¸è¯´äº†ï¼ŒåŠ ç­åŠ ç­~</p>\n<p>åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¦‚ä½•ä¿è¯è®¢å•IDçš„å…¨å±€å”¯ä¸€æ€§ï¼Ÿ</p></blockquote>\n<h2 id=\"æ ¸å¿ƒè¦ç‚¹\"><a href=\"#æ ¸å¿ƒè¦ç‚¹\" class=\"headerlink\" title=\"æ ¸å¿ƒè¦ç‚¹\"></a>æ ¸å¿ƒè¦ç‚¹</h2><p>é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä¼šä»ä»¥ä¸‹å‡ ç‚¹è€ƒè™‘ï¼š</p>\n<p>1ã€å¯ä»¥ä½¿ç”¨<strong>UUID&#x2F;GUID</strong>æ–¹æ¡ˆï¼Œå®ƒèƒ½ä¿è¯å…¨çƒèŒƒå›´å†…çš„å”¯ä¸€æ€§ï¼Œæ— éœ€ä¸­å¿ƒåŒ–åè°ƒï¼Œä½†ç¼ºç‚¹æ˜¯é•¿åº¦è¾ƒé•¿ä¸”æ— åºã€‚</p>\n<p>2ã€<strong>é›ªèŠ±ç®—æ³•(Snowflake)<strong>æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œå®ƒç”±<code>æ—¶é—´æˆ³+æœºå™¨ID+åºåˆ—å·</code>ç»„æˆï¼Œ</strong>æ—¢ä¿è¯äº†å”¯ä¸€æ€§åˆä¿è¯äº†æœ‰åºæ€§</strong>ï¼Œéå¸¸é€‚åˆè®¢å•ç³»ç»Ÿã€‚</p>\n<p>3ã€å¯¹äºå¤§å‹ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘<strong>å·æ®µæ¨¡å¼</strong>ï¼Œå³é›†ä¸­å¼IDç”Ÿæˆå™¨é¢„åˆ†é…ä¸€æ®µIDç»™å„æœåŠ¡ï¼Œå‡å°‘ç½‘ç»œè¯·æ±‚ã€‚</p>\n<p>4ã€è¿˜æœ‰<strong>Redisè‡ªå¢</strong>å’Œ<strong>æ•°æ®åº“è‡ªå¢ç­–ç•¥</strong>ç­‰ä¹Ÿæ˜¯å¸¸è§æ–¹æ¡ˆï¼Œä½†éœ€æ³¨æ„<strong>é«˜å¯ç”¨é—®é¢˜</strong>ã€‚</p>\n<p>å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä¼šæ ¹æ®å…·ä½“çš„ä¸šåŠ¡éœ€æ±‚ã€æ•°æ®é‡å’Œæ€§èƒ½è¦æ±‚é€‰æ‹©æœ€åˆé€‚çš„æ–¹æ¡ˆï¼Œé€šå¸¸<strong>é›ªèŠ±ç®—æ³•</strong>æ˜¯æœ€å‡è¡¡çš„é€‰æ‹©</p>\n<h2 id=\"è¯¦ç»†è§£æ\"><a href=\"#è¯¦ç»†è§£æ\" class=\"headerlink\" title=\"è¯¦ç»†è§£æ\"></a>è¯¦ç»†è§£æ</h2><h3 id=\"å…¨å±€å”¯ä¸€IDçš„æ ¸å¿ƒéœ€æ±‚-ğŸ¯\"><a href=\"#å…¨å±€å”¯ä¸€IDçš„æ ¸å¿ƒéœ€æ±‚-ğŸ¯\" class=\"headerlink\" title=\"å…¨å±€å”¯ä¸€IDçš„æ ¸å¿ƒéœ€æ±‚ ğŸ¯\"></a>å…¨å±€å”¯ä¸€IDçš„æ ¸å¿ƒéœ€æ±‚ ğŸ¯</h3><p>åšå¥½è®¢å•IDè®¾è®¡ï¼Œæˆ‘ä»¬éœ€è¦å…³æ³¨è¿™å‡ ç‚¹ï¼š</p>\n<ul>\n<li><p>å…¨å±€å”¯ä¸€æ€§ï¼šç¡®ä¿åœ¨æ•´ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¸ä¼šå‡ºç°é‡å¤ ID</p>\n</li>\n<li><p>é«˜æ€§èƒ½ï¼šç”Ÿæˆè¿‡ç¨‹è¦å¿«ï¼Œä¸èƒ½æˆä¸ºç³»ç»Ÿç“¶é¢ˆ</p>\n</li>\n<li><p>é«˜å¯ç”¨ï¼šID ç”Ÿæˆå™¨ä¸èƒ½æœ‰å•ç‚¹æ•…éšœ</p>\n</li>\n<li><p>è¶‹åŠ¿é€’å¢ï¼šå¯¹äºè®¢å•ç³»ç»Ÿï¼Œé€šå¸¸å¸Œæœ› ID ä¿æŒé€’å¢è¶‹åŠ¿ï¼Œä¾¿äºæ’åºå’Œåˆ†æ</p>\n</li>\n</ul>\n<h3 id=\"å¸¸è§è§£å†³æ–¹æ¡ˆåˆ†æ-ğŸ› ï¸\"><a href=\"#å¸¸è§è§£å†³æ–¹æ¡ˆåˆ†æ-ğŸ› ï¸\" class=\"headerlink\" title=\"å¸¸è§è§£å†³æ–¹æ¡ˆåˆ†æ ğŸ› ï¸\"></a>å¸¸è§è§£å†³æ–¹æ¡ˆåˆ†æ ğŸ› ï¸</h3><h4 id=\"1-UUID-GUID-ğŸ“Œ\"><a href=\"#1-UUID-GUID-ğŸ“Œ\" class=\"headerlink\" title=\"1. UUID&#x2F;GUID ğŸ“Œ\"></a>1. UUID&#x2F;GUID ğŸ“Œ</h4><div class=\"language-java\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">java</span><pre class=\"shiki material-theme\" style=\"background-color: #263238\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #C792EA\">String</span><span style=\"color: #EEFFFF\"> uuid </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> UUID</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">randomUUID</span><span style=\"color: #89DDFF\">().</span><span style=\"color: #82AAFF\">toString</span><span style=\"color: #89DDFF\">().</span><span style=\"color: #82AAFF\">replace</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">-</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&quot;&quot;</span><span style=\"color: #89DDFF\">);</span></span></code></pre></div><p>UUIDæ˜¯æœ€ç®€å•ç›´æ¥çš„æ–¹æ¡ˆï¼Œä½†å­˜åœ¨å‡ ä¸ªé—®é¢˜ï¼š</p>\n<ul>\n<li><p>é•¿åº¦è¿‡é•¿ï¼Œ16å­—èŠ‚</p>\n</li>\n<li><p>æ— åºæ€§å¯¼è‡´ç´¢å¼•æ•ˆç‡ä½ä¸‹</p>\n</li>\n<li><p>ç”¨æˆ·ä½“éªŒä¸å‹å¥½ï¼Œä¸å®¹æ˜“è®°å¿†å’Œæ²Ÿé€š</p>\n</li>\n</ul>\n<h4 id=\"2-é›ªèŠ±ç®—æ³•-Snowflake-â„ï¸\"><a href=\"#2-é›ªèŠ±ç®—æ³•-Snowflake-â„ï¸\" class=\"headerlink\" title=\"2. é›ªèŠ±ç®—æ³•(Snowflake) â„ï¸\"></a>2. é›ªèŠ±ç®—æ³•(Snowflake) â„ï¸</h4><p>é›ªèŠ±ç®—æ³•æ˜¯Twitterå¼€æºçš„åˆ†å¸ƒå¼IDç”Ÿæˆç®—æ³•ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯ï¼š</p>\n<ul>\n<li><p>1ä½ç¬¦å·ä½ï¼Œå›ºå®šä¸º0</p>\n</li>\n<li><p>41ä½æ—¶é—´æˆ³ï¼Œç²¾ç¡®åˆ°æ¯«ç§’</p>\n</li>\n<li><p>10ä½æœºå™¨IDï¼Œå¯ä»¥éƒ¨ç½²åœ¨1024ä¸ªèŠ‚ç‚¹</p>\n</li>\n<li><p>12ä½åºåˆ—å·ï¼ŒåŒä¸€æ¯«ç§’å†…å¯ç”Ÿæˆ4096ä¸ªID</p>\n</li>\n</ul>\n<p>ä¼˜åŠ¿éå¸¸æ˜æ˜¾ï¼š</p>\n<ul>\n<li><p>è¶‹åŠ¿è‡ªå¢ï¼Œæ»¡è¶³è®¢å•æ’åºéœ€æ±‚</p>\n</li>\n<li><p>ç”Ÿæˆæ•ˆç‡é«˜ï¼Œä¸ä¾èµ–ç¬¬ä¸‰æ–¹å­˜å‚¨</p>\n</li>\n<li><p>IDé•¿åº¦é€‚ä¸­</p>\n</li>\n<li><p>å¯ä»¥æ ¹æ®IDåè§£æå‡ºæ—¶é—´å’Œæœºå™¨ä¿¡æ¯ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥</p>\n</li>\n</ul>\n<p>å®ç°ç¤ºä¾‹ï¼š</p>\n<div class=\"language-java\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">java</span><pre class=\"shiki material-theme\" style=\"background-color: #263238\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #C792EA\">public</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">class</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #FFCB6B\">SnowflakeIdGenerator</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #C792EA\">private</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">final</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> workerId</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #C792EA\">private</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">final</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> datacenterId</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #C792EA\">private</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> sequence </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">0L</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">    </span><span style=\"color: #546E7A; font-style: italic\">// æ—¶é—´èµ·ç‚¹ (2017-01-01)</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #C792EA\">private</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">final</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> twepoch </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">1483200000000L</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">    </span><span style=\"color: #546E7A; font-style: italic\">// æœºå™¨IDä½æ•°ï¼Œæ•°æ®ä¸­å¿ƒIDä½æ•°ï¼Œåºåˆ—å·ä½æ•°</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #C792EA\">private</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">final</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> workerIdBits </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">5L</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #C792EA\">private</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">final</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> datacenterIdBits </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">5L</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #C792EA\">private</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">final</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> sequenceBits </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">12L</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">    </span><span style=\"color: #546E7A; font-style: italic\">// å„éƒ¨åˆ†æœ€å¤§å€¼</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #C792EA\">private</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">final</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> maxWorkerId </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">-</span><span style=\"color: #F78C6C\">1L</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">^</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">(-</span><span style=\"color: #F78C6C\">1L</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&lt;&lt;</span><span style=\"color: #EEFFFF\"> workerIdBits</span><span style=\"color: #89DDFF\">);</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #C792EA\">private</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">final</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> maxDatacenterId </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">-</span><span style=\"color: #F78C6C\">1L</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">^</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">(-</span><span style=\"color: #F78C6C\">1L</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&lt;&lt;</span><span style=\"color: #EEFFFF\"> datacenterIdBits</span><span style=\"color: #89DDFF\">);</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #C792EA\">private</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">final</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> sequenceMask </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">-</span><span style=\"color: #F78C6C\">1L</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">^</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">(-</span><span style=\"color: #F78C6C\">1L</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&lt;&lt;</span><span style=\"color: #EEFFFF\"> sequenceBits</span><span style=\"color: #89DDFF\">);</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">    </span><span style=\"color: #546E7A; font-style: italic\">// å„éƒ¨åˆ†åç§»é‡</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #C792EA\">private</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">final</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> workerIdShift </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> sequenceBits</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #C792EA\">private</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">final</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> datacenterIdShift </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> sequenceBits </span><span style=\"color: #89DDFF\">+</span><span style=\"color: #EEFFFF\"> workerIdBits</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #C792EA\">private</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">final</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> timestampLeftShift </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> sequenceBits </span><span style=\"color: #89DDFF\">+</span><span style=\"color: #EEFFFF\"> workerIdBits </span><span style=\"color: #89DDFF\">+</span><span style=\"color: #EEFFFF\"> datacenterIdBits</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #C792EA\">private</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> lastTimestamp </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">-</span><span style=\"color: #F78C6C\">1L</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">    </span><span style=\"color: #546E7A; font-style: italic\">// æ„é€ å‡½æ•°</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #C792EA\">public</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #82AAFF\">SnowflakeIdGenerator</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #EEFFFF; font-style: italic\">workerId</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #EEFFFF; font-style: italic\">datacenterId</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #EEFFFF\">workerId </span><span style=\"color: #89DDFF\">&gt;</span><span style=\"color: #EEFFFF\"> maxWorkerId </span><span style=\"color: #89DDFF\">||</span><span style=\"color: #EEFFFF\"> workerId </span><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">0</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">            </span><span style=\"color: #89DDFF; font-style: italic\">throw</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF; font-style: italic\">new</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #82AAFF\">IllegalArgumentException</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">Worker ID can&#39;t be greater than </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">+</span><span style=\"color: #EEFFFF\"> maxWorkerId </span><span style=\"color: #89DDFF\">+</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\"> or less than 0</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">);</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #EEFFFF\">datacenterId </span><span style=\"color: #89DDFF\">&gt;</span><span style=\"color: #EEFFFF\"> maxDatacenterId </span><span style=\"color: #89DDFF\">||</span><span style=\"color: #EEFFFF\"> datacenterId </span><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">0</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">            </span><span style=\"color: #89DDFF; font-style: italic\">throw</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF; font-style: italic\">new</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #82AAFF\">IllegalArgumentException</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">Datacenter ID can&#39;t be greater than </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">+</span><span style=\"color: #EEFFFF\"> maxDatacenterId </span><span style=\"color: #89DDFF\">+</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\"> or less than 0</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">);</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF\">this.</span><span style=\"color: #EEFFFF\">workerId </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> workerId</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF\">this.</span><span style=\"color: #EEFFFF\">datacenterId </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> datacenterId</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">    </span><span style=\"color: #546E7A; font-style: italic\">// ç”Ÿæˆä¸‹ä¸€ä¸ªID</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #C792EA\">public</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">synchronized</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #82AAFF\">nextId</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> timestamp </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #82AAFF\">timeGen</span><span style=\"color: #89DDFF\">();</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #EEFFFF\">timestamp </span><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #EEFFFF\"> lastTimestamp</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">            </span><span style=\"color: #89DDFF; font-style: italic\">throw</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF; font-style: italic\">new</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #82AAFF\">RuntimeException</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">Clock moved backwards. Refusing to generate id</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">);</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #EEFFFF\">lastTimestamp </span><span style=\"color: #89DDFF\">==</span><span style=\"color: #EEFFFF\"> timestamp</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">            sequence </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #EEFFFF\">sequence </span><span style=\"color: #89DDFF\">+</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&amp;</span><span style=\"color: #EEFFFF\"> sequenceMask</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">            </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #EEFFFF\">sequence </span><span style=\"color: #89DDFF\">==</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">0</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">                timestamp </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #82AAFF\">tilNextMillis</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #EEFFFF\">lastTimestamp</span><span style=\"color: #89DDFF\">);</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">            </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF\">&#125;</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF; font-style: italic\">else</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">            sequence </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">0L</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        lastTimestamp </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> timestamp</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">((</span><span style=\"color: #EEFFFF\">timestamp </span><span style=\"color: #89DDFF\">-</span><span style=\"color: #EEFFFF\"> twepoch</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&lt;&lt;</span><span style=\"color: #EEFFFF\"> timestampLeftShift</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">|</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">                </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #EEFFFF\">datacenterId </span><span style=\"color: #89DDFF\">&lt;&lt;</span><span style=\"color: #EEFFFF\"> datacenterIdShift</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">|</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">                </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #EEFFFF\">workerId </span><span style=\"color: #89DDFF\">&lt;&lt;</span><span style=\"color: #EEFFFF\"> workerIdShift</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">|</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">                sequence</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #C792EA\">private</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #82AAFF\">tilNextMillis</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #EEFFFF; font-style: italic\">lastTimestamp</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> timestamp </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #82AAFF\">timeGen</span><span style=\"color: #89DDFF\">();</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF; font-style: italic\">while</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #EEFFFF\">timestamp </span><span style=\"color: #89DDFF\">&lt;=</span><span style=\"color: #EEFFFF\"> lastTimestamp</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">            timestamp </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #82AAFF\">timeGen</span><span style=\"color: #89DDFF\">();</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #EEFFFF\"> timestamp</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #C792EA\">private</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #C792EA\">long</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #82AAFF\">timeGen</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #EEFFFF\"> System</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">currentTimeMillis</span><span style=\"color: #89DDFF\">();</span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#125;</span></span></code></pre></div><h4 id=\"3-å·æ®µæ¨¡å¼-ğŸ”¢\"><a href=\"#3-å·æ®µæ¨¡å¼-ğŸ”¢\" class=\"headerlink\" title=\"3. å·æ®µæ¨¡å¼ ğŸ”¢\"></a>3. å·æ®µæ¨¡å¼ ğŸ”¢</h4><p>å·æ®µæ¨¡å¼æ˜¯ä¸€ç§ä¼˜åŒ–çš„ä¸­å¿ƒåŒ–IDåˆ†é…ç­–ç•¥ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯ï¼š</p>\n<ul>\n<li><p>ä¸­å¿ƒæœåŠ¡ä¸€æ¬¡æ€§åˆ†é…ä¸€æ®µIDç»™åº”ç”¨æœåŠ¡å™¨</p>\n</li>\n<li><p>åº”ç”¨æœåŠ¡å™¨åœ¨å†…å­˜ä¸­åˆ†é…è¿™æ®µIDï¼Œç”¨å®Œå†å»ç”³è¯·</p>\n</li>\n<li><p>å‡å°‘äº†é¢‘ç¹ç½‘ç»œè¯·æ±‚ï¼Œæé«˜äº†æ€§èƒ½</p>\n</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/sunknightzy/picsee/main/Picsee/abnerworks.Typora/1748336533114-5bec8e86-7364-4a36-ae8e-a54ee864df0c-TyvRFj.png\"></p>\n<h4 id=\"4-å…¶ä»–æ–¹æ¡ˆæ¯”è¾ƒ-ğŸ“Š\"><a href=\"#4-å…¶ä»–æ–¹æ¡ˆæ¯”è¾ƒ-ğŸ“Š\" class=\"headerlink\" title=\"4. å…¶ä»–æ–¹æ¡ˆæ¯”è¾ƒ ğŸ“Š\"></a>4. å…¶ä»–æ–¹æ¡ˆæ¯”è¾ƒ ğŸ“Š</h4><table>\n<thead>\n<tr>\n<th>æ–¹æ¡ˆ</th>\n<th>ä¼˜ç‚¹</th>\n<th>ç¼ºç‚¹</th>\n<th>é€‚ç”¨åœºæ™¯</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>æ•°æ®åº“è‡ªå¢ID</td>\n<td>ç®€å•æ˜“å®ç°ï¼Œæœ‰åº</td>\n<td>å•ç‚¹æ•…éšœé£é™©ï¼Œæ€§èƒ½ç“¶é¢ˆ</td>\n<td>å°å‹ç³»ç»Ÿï¼Œæ•°æ®é‡ä¸å¤§</td>\n</tr>\n<tr>\n<td>Redisè‡ªå¢</td>\n<td>æ€§èƒ½è¾ƒå¥½ï¼Œå®ç°ç®€å•</td>\n<td>éœ€è¦è€ƒè™‘æŒä¹…åŒ–ï¼Œå¯é æ€§é—®é¢˜</td>\n<td>ä¸­å‹ç³»ç»Ÿï¼Œå¯¹æ€§èƒ½æœ‰ä¸€å®šè¦æ±‚</td>\n</tr>\n<tr>\n<td>é›ªèŠ±ç®—æ³•</td>\n<td>é«˜æ€§èƒ½ï¼Œæ— å•ç‚¹ï¼Œè¶‹åŠ¿é€’å¢</td>\n<td>éœ€è¦è§£å†³æ—¶é’Ÿå›é€€é—®é¢˜</td>\n<td>å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿ</td>\n</tr>\n<tr>\n<td>UUID</td>\n<td>ç®€å•ï¼Œæ— éœ€ä¸­å¿ƒåŒ–æœåŠ¡</td>\n<td>æ— åºï¼Œé•¿åº¦é•¿ï¼Œç´¢å¼•æ•ˆç‡ä½</td>\n<td>å¯¹IDæ ¼å¼æ— ç‰¹æ®Šè¦æ±‚çš„åœºæ™¯</td>\n</tr>\n<tr>\n<td>å·æ®µæ¨¡å¼</td>\n<td>å‡å°‘ç½‘ç»œè¯·æ±‚ï¼Œé«˜æ€§èƒ½</td>\n<td>å®ç°ç¨å¤æ‚ï¼Œéœ€è¦é›†ä¸­ç®¡ç†</td>\n<td>å¤§å‹ç³»ç»Ÿï¼Œå¯¹æ€§èƒ½è¦æ±‚é«˜</td>\n</tr>\n</tbody></table>\n<h3 id=\"å®æˆ˜å»ºè®®-ğŸš€\"><a href=\"#å®æˆ˜å»ºè®®-ğŸš€\" class=\"headerlink\" title=\"å®æˆ˜å»ºè®® ğŸš€\"></a>å®æˆ˜å»ºè®® ğŸš€</h3><p>åœ¨é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é€‰æ‹©äº†é›ªèŠ±ç®—æ³•ä½œä¸ºè®¢å•IDç”Ÿæˆæ–¹æ¡ˆï¼Œå¹¶åšäº†ä»¥ä¸‹æ”¹è¿›ï¼š</p>\n<ol>\n<li>è§£å†³æ—¶é’Ÿå›æ‹¨é—®é¢˜ - åŠ å…¥äº†æ—¶é’Ÿå›æ‹¨æ£€æµ‹æœºåˆ¶ï¼Œå¦‚æœå‘ç°å›æ‹¨ï¼Œä¼šç­‰å¾…ä¸€æ®µæ—¶é—´æˆ–æŠ¥è­¦</li>\n<li>æœºå™¨IDåˆ†é… - ä½¿ç”¨Zookeeperè‡ªåŠ¨åˆ†é…æœºå™¨IDï¼Œé¿å…æ‰‹åŠ¨é…ç½®</li>\n<li>æ¯ç§’å¯ç”Ÿæˆ409.6ä¸‡ä¸ªIDï¼Œå®Œå…¨æ»¡è¶³é«˜å¹¶å‘éœ€æ±‚</li>\n</ol>\n<p>å½“ä½ é‡åˆ°è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæˆ‘å»ºè®®ï¼š</p>\n<ol>\n<li>åˆ†æä½ çš„ä¸šåŠ¡éœ€æ±‚ï¼šIDæ˜¯å¦éœ€è¦æœ‰åºï¼Ÿæ•°æ®è§„æ¨¡æœ‰å¤šå¤§ï¼Ÿ</li>\n<li>è¯„ä¼°ç³»ç»Ÿçš„å¯ç”¨æ€§è¦æ±‚å’Œæ€§èƒ½éœ€æ±‚</li>\n<li>ä¸­å°å‹ç³»ç»Ÿå¯ä»¥è€ƒè™‘Redis+Luaæˆ–æ”¹è¿›çš„é›ªèŠ±ç®—æ³•</li>\n<li>å¤§å‹ç³»ç»Ÿå»ºè®®ä½¿ç”¨é›ªèŠ±ç®—æ³•æˆ–å·æ®µæ¨¡å¼</li>\n</ol>\n<p>æ ¸å¿ƒæ˜¯ï¼Œ<strong>ä¸è¦è¿‡åº¦è®¾è®¡</strong>ï¼Œé€‰æ‹©æ»¡è¶³éœ€æ±‚çš„æœ€ç®€æ–¹æ¡ˆï¼ŒåŒæ—¶é¢„ç•™æ‰©å±•ç©ºé—´ï¼Œè¿™æ ·æ‰èƒ½æ—¢æ»¡è¶³ä¸šåŠ¡éœ€æ±‚ï¼Œåˆèƒ½ä¿è¯ç³»ç»Ÿçš„å¥å£®æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>\n","feature":true,"text":"æ–‡ç« æè¿°äº†Javaä¸­å®ç°åˆ†å¸ƒå¼IDçš„å‡ ç§è®¾è®¡æ–¹æ¡ˆ, ä»¥åŠä»–ä»¬çš„ä¼˜ç¼ºç‚¹...","permalink":"/post/åˆ†å¸ƒå¼IDè®¾è®¡æ–¹æ¡ˆ","photos":[],"count_time":{"symbolsCount":"4.3k","symbolsTime":"4 mins."},"categories":[{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","count":2,"path":"api/categories/åˆ†å¸ƒå¼.json"}],"tags":[{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","count":2,"path":"api/tags/åˆ†å¸ƒå¼.json"},{"name":"åˆ†å¸ƒå¼ID","slug":"åˆ†å¸ƒå¼ID","count":1,"path":"api/tags/åˆ†å¸ƒå¼ID.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%A0%B8%E5%BF%83%E8%A6%81%E7%82%B9\"><span class=\"toc-text\">æ ¸å¿ƒè¦ç‚¹</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90\"><span class=\"toc-text\">è¯¦ç»†è§£æ</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%85%A8%E5%B1%80%E5%94%AF%E4%B8%80ID%E7%9A%84%E6%A0%B8%E5%BF%83%E9%9C%80%E6%B1%82-%F0%9F%8E%AF\"><span class=\"toc-text\">å…¨å±€å”¯ä¸€IDçš„æ ¸å¿ƒéœ€æ±‚ ğŸ¯</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%B8%B8%E8%A7%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%88%86%E6%9E%90-%F0%9F%9B%A0%EF%B8%8F\"><span class=\"toc-text\">å¸¸è§è§£å†³æ–¹æ¡ˆåˆ†æ ğŸ› ï¸</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1-UUID-GUID-%F0%9F%93%8C\"><span class=\"toc-text\">1. UUID&#x2F;GUID ğŸ“Œ</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-%E9%9B%AA%E8%8A%B1%E7%AE%97%E6%B3%95-Snowflake-%E2%9D%84%EF%B8%8F\"><span class=\"toc-text\">2. é›ªèŠ±ç®—æ³•(Snowflake) â„ï¸</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-%E5%8F%B7%E6%AE%B5%E6%A8%A1%E5%BC%8F-%F0%9F%94%A2\"><span class=\"toc-text\">3. å·æ®µæ¨¡å¼ ğŸ”¢</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4-%E5%85%B6%E4%BB%96%E6%96%B9%E6%A1%88%E6%AF%94%E8%BE%83-%F0%9F%93%8A\"><span class=\"toc-text\">4. å…¶ä»–æ–¹æ¡ˆæ¯”è¾ƒ ğŸ“Š</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AE%9E%E6%88%98%E5%BB%BA%E8%AE%AE-%F0%9F%9A%80\"><span class=\"toc-text\">å®æˆ˜å»ºè®® ğŸš€</span></a></li></ol></li></ol>","author":{"name":"GlassCat","slug":"blog-author","avatar":"/img/avatar.png","link":"/","description":"ã€Šè®ºè¯­Â·ä¸ºæ”¿ã€‹<br/>å¾å°ç»ˆæ—¥ä¸é£Ÿï¼Œç»ˆå¤œä¸å¯ï¼Œä»¥æ€æ— ç›Šï¼Œä¸å¦‚å­¦ä¹Ÿ<br/>--å­”å­--","socials":{"github":"https://github.com/sunknightzy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/someaware","csdn":"","juejin":"","customs":{"mail":{"icon":"/svg/mail.svg","link":"mailto:593739859@qq.com"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"MacBook åç«¯ç¯å¢ƒæ­å»º","uid":"ebab0b3cf4c39bee5f017078a6c91559","slug":"MacBook-åç«¯ç¯å¢ƒæ­å»º","date":"2018-03-31T03:36:42.000Z","updated":"2018-04-01T05:36:42.000Z","comments":true,"path":"api/articles/MacBook-åç«¯ç¯å¢ƒæ­å»º.json","keywords":null,"cover":"https://raw.githubusercontent.com/sunknightzy/picsee/main/Picsee/abnerworks.Typora/coverbZ9Hhj-CJ6c50.png","text":"è¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»äº†åœ¨ MacBook ä¸Šæ­å»ºåç«¯å¼€å‘ç¯å¢ƒçš„è¯¦ç»†æ­¥éª¤ï¼ŒåŒ…æ‹¬ç»ˆç«¯å·¥å…·ã€åŒ…ç®¡ç†å™¨ã€ç‰ˆæœ¬æ§åˆ¶å·¥å…·ã€å¼€å‘å·¥å…·åŠæ’ä»¶çš„é…ç½®ï¼Œä»¥åŠé€šè¿‡ Docker å®‰è£…ä¸­é—´ä»¶çš„æ–¹æ³•...","permalink":"/post/MacBook-åç«¯ç¯å¢ƒæ­å»º","photos":[],"count_time":{"symbolsCount":"2.5k","symbolsTime":"2 mins."},"categories":[{"name":"MacBook","slug":"MacBook","count":3,"path":"api/categories/MacBook.json"},{"name":"ç¯å¢ƒæ­å»º","slug":"MacBook/ç¯å¢ƒæ­å»º","count":3,"path":"api/categories/MacBook/ç¯å¢ƒæ­å»º.json"}],"tags":[{"name":"MacBook","slug":"MacBook","count":3,"path":"api/tags/MacBook.json"},{"name":"ç¯å¢ƒæ­å»º","slug":"ç¯å¢ƒæ­å»º","count":3,"path":"api/tags/ç¯å¢ƒæ­å»º.json"}],"author":{"name":"GlassCat","slug":"blog-author","avatar":"/img/avatar.png","link":"/","description":"ã€Šè®ºè¯­Â·ä¸ºæ”¿ã€‹<br/>å¾å°ç»ˆæ—¥ä¸é£Ÿï¼Œç»ˆå¤œä¸å¯ï¼Œä»¥æ€æ— ç›Šï¼Œä¸å¦‚å­¦ä¹Ÿ<br/>--å­”å­--","socials":{"github":"https://github.com/sunknightzy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/someaware","csdn":"","juejin":"","customs":{"mail":{"icon":"/svg/mail.svg","link":"mailto:593739859@qq.com"}}}},"feature":true},"next_post":{"title":"åˆ†å¸ƒå¼é”çš„ä¸‰ç§å®ç°æ–¹æ¡ˆ","uid":"109296d43a046ab98a4514702e34310a","slug":"åˆ†å¸ƒå¼é”çš„ä¸‰ç§å®ç°æ–¹æ¡ˆ","date":"2017-08-05T05:04:29.000Z","updated":"2019-06-03T04:34:29.000Z","comments":true,"path":"api/articles/åˆ†å¸ƒå¼é”çš„ä¸‰ç§å®ç°æ–¹æ¡ˆ.json","keywords":null,"cover":"https://raw.githubusercontent.com/sunknightzy/picsee/main/Picsee/abnerworks.Typora/images-GlLiWS.jpeg","text":"æ–‡ç« æè¿°äº†Javaä¸­å®ç°åˆ†å¸ƒå¼é”çš„ä¸‰ç§æ–¹æ¡ˆ,ä»¥åŠä»–ä»¬çš„ä¼˜ç¼ºç‚¹...","permalink":"/post/åˆ†å¸ƒå¼é”çš„ä¸‰ç§å®ç°æ–¹æ¡ˆ","photos":[],"count_time":{"symbolsCount":"20k","symbolsTime":"18 mins."},"categories":[{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","count":2,"path":"api/categories/åˆ†å¸ƒå¼.json"}],"tags":[{"name":"MySQL","slug":"MySQL","count":2,"path":"api/tags/MySQL.json"},{"name":"Zookeeper","slug":"Zookeeper","count":2,"path":"api/tags/Zookeeper.json"},{"name":"Redis","slug":"Redis","count":2,"path":"api/tags/Redis.json"},{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","count":2,"path":"api/tags/åˆ†å¸ƒå¼.json"},{"name":"åˆ†å¸ƒå¼é”","slug":"åˆ†å¸ƒå¼é”","count":1,"path":"api/tags/åˆ†å¸ƒå¼é”.json"}],"author":{"name":"GlassCat","slug":"blog-author","avatar":"/img/avatar.png","link":"/","description":"ã€Šè®ºè¯­Â·ä¸ºæ”¿ã€‹<br/>å¾å°ç»ˆæ—¥ä¸é£Ÿï¼Œç»ˆå¤œä¸å¯ï¼Œä»¥æ€æ— ç›Šï¼Œä¸å¦‚å­¦ä¹Ÿ<br/>--å­”å­--","socials":{"github":"https://github.com/sunknightzy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/someaware","csdn":"","juejin":"","customs":{"mail":{"icon":"/svg/mail.svg","link":"mailto:593739859@qq.com"}}}},"feature":true}}